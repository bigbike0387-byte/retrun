<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Dashboard - ‡∏Ñ‡∏£‡∏±‡∏ß‡∏£‡∏µ‡πÄ‡∏ó‡∏¥‡∏ô</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.05);
            padding: 5px;
            border-radius: 12px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            color: #666;
        }

        .tab-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .admin-table img {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            object-fit: cover;
        }

        .stock-warning {
            color: var(--danger);
            font-weight: bold;
        }
    </style>
</head>

<body>

    <header class="header">
        <div class="logo">Owner Portal <small>(‡∏Ñ‡∏∏‡∏ì‡∏®‡∏£‡∏±‡∏ì)</small></div>
        <nav style="display: flex; gap: 10px; align-items: center;">
            <div id="owner-noti-badge" class="badge badge-danger" style="display: none;">!</div>
            <button class="btn btn-outline btn-sm" onclick="handleLogout()" title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"><i
                    class="fas fa-sign-out-alt"></i></button>
        </nav>
    </header>

    <main class="container">
        <!-- Dashboard Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('reports')"><i class="fas fa-chart-line"></i> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô &
                ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
            <button class="tab-btn" onclick="switchTab('management')"><i class="fas fa-tasks"></i>
                ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</button>
        </div>

        <!-- Section 1: Reports -->
        <div id="tab-reports" class="tab-content active">
            <div class="grid mb-2">
                <div class="card stat-card" style="border-left-color: var(--success);">
                    <i class="fas fa-coins fa-2x text-primary"></i>
                    <h2 id="sales-daily" class="mt-2">0‡∏ø</h2>
                    <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                </div>
                <div class="card stat-card" style="border-left-color: var(--info);">
                    <i class="fas fa-calendar-check fa-2x text-primary"></i>
                    <h2 id="sales-monthly" class="mt-2">0‡∏ø</h2>
                    <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                </div>
                <div class="card stat-card" style="border-left-color: var(--purple);">
                    <i class="fas fa-receipt fa-2x text-primary"></i>
                    <h2 id="total-paid-orders" class="mt-2">0</h2>
                    <p>‡∏ö‡∏¥‡∏•‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß</p>
                </div>
            </div>

            <div class="grid" style="grid-template-columns: 2fr 1fr;">
                <section>
                    <div class="card">
                        <h3>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)</h3>
                        <div id="hourly-chart"
                            style="display: flex; align-items: flex-end; gap: 5px; height: 120px; margin-top: 20px; border-bottom: 2px solid #eee; padding-bottom: 5px;">
                        </div>
                    </div>
                    <div class="card">
                        <div class="flex-between">
                            <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
                            <button class="btn btn-sm btn-outline" onclick="handleExportData()">Excel CSV</button>
                        </div>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>‡πÇ‡∏ï‡πä‡∏∞</th>
                                        <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                                        <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                                    </tr>
                                </thead>
                                <tbody id="owner-history-body"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
                <aside>
                    <div class="card">
                        <h3>5 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</h3>
                        <div id="owner-best-sellers" class="mt-2"></div>
                    </div>
                    <div class="card">
                        <h3>‡∏Ñ‡∏≥‡∏ï‡∏¥‡∏ä‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
                        <div id="owner-review-list" class="mt-2" style="max-height: 300px; overflow-y: auto;"></div>
                    </div>
                </aside>
            </div>
        </div>

        <!-- Section 2: Management -->
        <div id="tab-management" class="tab-content">
            <div class="grid" style="grid-template-columns: 1.2fr 2fr;">
                <aside>
                    <!-- Quick Issue Support -->
                    <div class="card" style="background: #fff5f5; border-color: #feb2b2;">
                        <h3>üîî ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h3>
                        <div id="owner-issue-list" class="mt-2"></div>
                    </div>

                    <!-- Promo Management -->
                    <div class="card">
                        <div class="flex-between">
                            <h3>üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</h3>
                            <button class="btn btn-sm btn-primary" onclick="openPromoModal()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                        </div>
                        <div id="owner-promo-list" class="mt-2"></div>
                    </div>

                    <!-- Staff Status -->
                    <div class="card" style="background: var(--dark); color: white;">
                        <h4>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</h4>
                        <p style="font-size: 0.85rem; opacity: 0.8; margin-top: 10px;">
                            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡πâ‡∏≤‡∏ô: <span class="badge badge-success">‡πÄ‡∏õ‡∏¥‡∏î</span><br>
                            KDS ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå: staff_kds<br>
                            ‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå: <i class="fas fa-check-circle text-success"></i> Connected
                        </p>
                    </div>
                </aside>

                <section>
                    <div class="card">
                        <div class="flex-between">
                            <h3>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                            <button class="btn btn-primary" onclick="openMenuModal()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà</button>
                        </div>
                        <div class="table-responsive mt-2">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>‡∏£‡∏π‡∏õ</th>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                                        <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                                        <th>‡∏™‡∏ï‡πá‡∏≠‡∏Å</th>
                                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="owner-menu-manage-body"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div id="menu-modal" class="modal-overlay" style="display: none;">
        <div class="card modal-content">
            <h3 id="menu-modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
            <form id="menu-form" onsubmit="handleSaveMenu(event)" class="mt-2">
                <input type="hidden" id="edit-menu-id">
                <div class="mb-2">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</label>
                    <input type="text" id="m-name" required class="form-control">
                </div>
                <div class="grid mb-2">
                    <div><label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ø)</label><input type="number" id="m-price" required class="form-control"></div>
                    <div><label>‡∏™‡∏ï‡πá‡∏≠‡∏Å</label><input type="number" id="m-stock" required class="form-control"></div>
                </div>
                <div class="mb-2">
                    <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <select id="m-cat" class="form-control">
                        <option>‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                        <option>‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß</option>
                        <option>‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô</option>
                        <option>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
                    </select>
                </div>
                <div class="mb-2">
                    <label>URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
                    <input type="text" id="m-img" class="form-control" placeholder="https://...">
                </div>
                <div class="flex-between mt-2" style="gap:10px;">
                    <button type="submit" class="btn btn-primary" style="flex:2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-outline" style="flex:1"
                        onclick="closeMenuModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="promo-modal" class="modal-overlay" style="display: none;">
        <div class="card modal-content">
            <h3>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏´‡∏±‡∏™‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</h3>
            <form id="promo-form" onsubmit="handleSavePromo(event)" class="mt-2">
                <div class="mb-2"><label>‡πÇ‡∏Ñ‡πâ‡∏î</label><input type="text" id="p-code" required class="form-control"
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô HELLO10"></div>
                <div class="grid mb-2">
                    <div><label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label><select id="p-type" class="form-control">
                            <option value="percent">%</option>
                            <option value="flat">‡∏ø</option>
                        </select></div>
                    <div><label>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</label><input type="number" id="p-value" required class="form-control"></div>
                </div>
                <div class="mb-2"><label>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (‡∏ø)</label><input type="number" id="p-min" required
                        class="form-control"></div>
                <div class="flex-between mt-2" style="gap:10px;">
                    <button type="submit" class="btn btn-primary" style="flex:2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-outline" style="flex:1"
                        onclick="closePromoModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="resolve-modal" class="modal-overlay" style="display: none;">
        <div class="card modal-content">
            <h3 id="resolve-title">‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h3>
            <p id="resolve-info" class="mt-1" style="background:#eee; padding:10px; border-radius:8px;"></p>
            <textarea id="resolve-text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç..." class="mt-2"
                style="width:100%; height:80px; padding:10px; border-radius:10px; border:1px solid #ddd;"></textarea>
            <button class="btn btn-primary mt-2" style="width:100%"
                onclick="handleConfirmResolve()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
        </div>
    </div>

    <script src="js/storage.js"></script>
    <script src="js/sync-template.js"></script>
    <script src="js/owner.js"></script>
</body>

</html>